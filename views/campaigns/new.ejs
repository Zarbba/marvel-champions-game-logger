<%- include(`../partials/header`) %>
<h2>Create a new campaign log</h2>
<div class="message">
    <% if(locals.message) {%> <%= message %><% } %>
</div>
<form action="/campaigns" method="post">
    <label for="campaign-name">Campaign Name:</label>
    <input id="campaign-name" type="text" name="campaignName" required <% if (locals.campaign) { %> value="<%= campaign.campaignName %>" <% } %>>
    <label for="campaign-type">Campaign:</label>
        <select id="campaign-type" name="campaignType">
            <option value="TheRiseOfRedSkull" <% if (locals.campaign && campaign.campaignType === `The Rise of Red Skull`) { %> selected <% } %>>The Rise of Red Skull</option>
            <option value="TheGalaxysMostWanted" <% if (locals.campaign && campaign.campaignType === `The Galaxy's Most Wanted`) { %> selected <% } %>>The Galaxy's Most Wanted</option>
            <option value="TheMadTitansShadow" <% if (locals.campaign && campaign.campaignType === `The Mad Titan's Shadow`) { %> selected <% } %>>The Mad Titan's Shadow</option>
            <option value="SinisterMotives" <% if (locals.campaign && campaign.campaignType === `Sinister Motives`) { %> selected <% } %>>Sinister Motives</option>
            <option value="MutantGenesis" <% if (locals.campaign && campaign.campaignType === `Mutant Genesis`) { %> selected <% } %>>Mutant Genesis</option>
            <option value="NeXtEvolution" <% if (locals.campaign && campaign.campaignType === `NeXt Evolution`) { %> selected <% } %>>NeXt Evolution</option>
            <option value="AgeOfApocalypse" <% if (locals.campaign && campaign.campaignType === `Age of Apocalypse`) { %> selected <% } %>>Age of Apocalypse</option>
            <option class="hidden" value="" <% if (!locals.campaign) { %> selected <% } %>></option>
        </select>
    <h3>Campaign Information:</h3>
    <%- include(`./partials/sinister-motives/new`) %>
    <section class="game-section">
        <% if (locals.campaign) { %>
            <% campaign.games.forEach( (game) => { %>
                <fieldset class="game-widget">
                    <label>
                        Select a game to add:
                        <select name="games">
                            <% ownedGames.forEach( (ownedGame) => { %>
                                <option value="<%= ownedGame._id %>" <%= ownedGame._id === game._id && selected %>><%= ownedGame.gameName %></option>
                            <% }) %>
                        </select>
                    </label>
                    <button type="button" class="game-button button remove">Remove Game</button>
                </fieldset>
                <% }) %>
        <% } %>
        <fieldset class="game-widget hidden" id="default-widget">
            <label>
                Select a game to add:
                <select name="games">
                    <% ownedGames.forEach( (ownedGame) => { %>
                        <option value="<%= ownedGame._id %>"><%= ownedGame.gameName %></option>
                    <% }) %>
                    <option class="hidden" value="" selected></option>
                </select>
            </label>
            <button type="button" class="game-button button remove">Remove Game</button>
        </fieldset>
    </section>
    <button type="button" class="game-button button add">Add a game</button>
    <section class="player-section">
        <% if (locals.campaign) { %>
            <% campaign.players.forEach( (player, i) => { %>
                <fieldset class="player-widget player<%= i %>">
                    <label class="player-element">
                        Player Name:
                        <input type="text" name="playerName" required value="<%= player.player.playerName %>">
                    </label>
                    <label class="hero-element">
                        Hero:
                        <input type="text" name="playerHero" required value="<%= player.identity %>">
                    </label>
                    <label class="owner-element">
                        Owner:
                        <input type="text" name="playerOwner" value="<%= player.player.owner %>">
                    </label>
                    <button type="button" class="player-button button remove">Remove Player</button>
                </fieldset>
                <% }) %>
        <% } %>
    </section>
    <button type="button" class="player-button button add">Add a player</button>
    <label for="expert-mode">Campaign Difficulty:</label>
    <select id="expert-mode" name="expertMode">
        <option value="false" <% if (!locals.campaign || locals.campaign.modes.expert === false) { %> selected <% } %>>Standard</option>
        <option value="true" <% if (locals.campaign && campaign.campaign.modes.expert === true) { %> selected <% } %>>Expert</option>
    </select>
    <label for="heroic-mode">Heroic Mode Modifier:</label>
    <select id="heroic-mode" name="heroicMode">
        <option value="0" <% if (!locals.campaign || locals.campaign.modes.heroic === 0) { %> selected <% } %>>0</option>
        <option value="1" <% if (locals.campaign && locals.campaign.modes.heroic === 1) { %> selected <% } %>>1</option>
        <option value="2" <% if (locals.campaign && locals.campaign.modes.heroic === 2) { %> selected <% } %>>2</option>
        <option value="3" <% if (locals.campaign && locals.campaign.modes.heroic === 3) { %> selected <% } %>>3</option>
        <option value="4" <% if (locals.campaign && locals.campaign.modes.heroic === 4) { %> selected <% } %>>4</option>
    </select>
    <label for="notes">Notes:</label>
    <textarea id="notes" type="" name="notes" rows="6" cols="40"><% if (locals.game) { %><%=game.notes%><% } %></textarea>
    <button>Log Campaign</button>
</form>
<%- include(`../partials/footer`) %>